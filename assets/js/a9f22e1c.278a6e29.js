"use strict";(self.webpackChunkredstone_docs=self.webpackChunkredstone_docs||[]).push([[167],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var d=r.createContext({}),s=function(e){var t=r.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=s(e.components);return r.createElement(d.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,d=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=s(n),m=a,h=p["".concat(d,".").concat(m)]||p[m]||u[m]||o;return n?r.createElement(h,i(i({ref:t},c),{},{components:n})):r.createElement(h,i({ref:t},c))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=p;var l={};for(var d in t)hasOwnProperty.call(t,d)&&(l[d]=t[d]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var s=2;s<o;s++)i[s]=n[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}p.displayName="MDXCreateElement"},8984:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var r=n(7462),a=(n(7294),n(3905));const o={sidebar_position:1,sidebar_label:"Running Oracle Node"},i="Running Oracle Node",l={unversionedId:"data-providers/running-oracle-node",id:"data-providers/running-oracle-node",title:"Running Oracle Node",description:"This guide will teach you how to run a RedStone node with Docker. It will fetch data from main public APIs, sign them with your pirvate keys and broadcast to the streamr network and redstone data delivery network.",source:"@site/docs/data-providers/running-oracle-node.md",sourceDirName:"data-providers",slug:"/data-providers/running-oracle-node",permalink:"/docs/data-providers/running-oracle-node",draft:!1,editUrl:"https://github.com/redstone-finance/redstone-docs/tree/main/docs/data-providers/running-oracle-node.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,sidebar_label:"Running Oracle Node"},sidebar:"tutorialSidebar",previous:{title:"Data Providers",permalink:"/docs/category/data-providers"},next:{title:"Best practices",permalink:"/docs/data-providers/best-practices"}},d={},s=[{value:"1. Running a node locally",id:"1-running-a-node-locally",level:2},{value:"Requirements",id:"requirements",level:3},{value:"Node configuration",id:"node-configuration",level:3},{value:"Launch using Docker",id:"launch-using-docker",level:3},{value:"2. Running a production node",id:"2-running-a-production-node",level:2},{value:"Reach out to the RedStone team",id:"reach-out-to-the-redstone-team",level:3},{value:"Deploy your node",id:"deploy-your-node",level:3}],c={toc:s};function u(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"running-oracle-node"},"Running Oracle Node"),(0,a.kt)("p",null,"This guide will teach you how to run a RedStone node with Docker. It will fetch data from main public APIs, sign them with your pirvate keys and broadcast to the streamr network and redstone data delivery network."),(0,a.kt)("admonition",{title:"Running from source",type:"info"},(0,a.kt)("p",{parentName:"admonition"},"You can run RedStone oracle node ",(0,a.kt)("a",{parentName:"p",href:"./launch-using-source-code"},"using source code"),", but it's recommended to run it with Docker. We continuously build and deploy the code from our Github repository, so you don\u2019t need a complete development environment to run a node.")),(0,a.kt)("admonition",{title:"Data availability",type:"info"},(0,a.kt)("p",{parentName:"admonition"},"RedStone consumers will be able to use the data published by your node ",(0,a.kt)("a",{parentName:"p",href:"../smart-contract-devs/supported-chains"},"on all supported chains.")," You can learn more about the RedStone Oracles architecture ",(0,a.kt)("a",{parentName:"p",href:"/docs/smart-contract-devs/how-it-works"},"here."))),(0,a.kt)("h2",{id:"1-running-a-node-locally"},"1. Running a node locally"),(0,a.kt)("h3",{id:"requirements"},"Requirements"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Make sure to have enough resources to launch a RedStone oracle node, as explained in the ",(0,a.kt)("a",{parentName:"li",href:"./system-requirements"},"requirements page.")),(0,a.kt)("li",{parentName:"ul"},"Install ",(0,a.kt)("a",{parentName:"li",href:"https://docs.docker.com/get-docker/"},"Docker"),". You will run the oracle node in a Docker container.")),(0,a.kt)("h3",{id:"node-configuration"},"Node configuration"),(0,a.kt)("p",null,"RedStone oracle node should be configured using environment variables. You can configure them in any preferred way, e.g. using a local ",(0,a.kt)("inlineCode",{parentName:"p"},".env")," file."),(0,a.kt)("admonition",{title:"Quick start configuration",type:"success"},(0,a.kt)("p",{parentName:"admonition"},"We've prepared a simple .env file and a bash script so you can quickly run your first oracle node. You can find them ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/redstone-finance/redstone-oracles-monorepo/tree/main/packages/oracle-node/tools/quick-start"},"here."))),(0,a.kt)("admonition",{title:"More env variables",type:"info"},(0,a.kt)("p",{parentName:"admonition"},"The table below contains the main environment variables required for running a node. To see all the supported environment variables (including optional), please take a look at ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/redstone-finance/redstone-oracles-monorepo/blob/main/packages/oracle-node/src/config.ts"},"this file."))),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Param"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"),(0,a.kt)("th",{parentName:"tr",align:null},"Example value"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"ECDSA_PRIVATE_KEY"),(0,a.kt)("td",{parentName:"tr",align:null},"Your ECDSA private key"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"ECDSA_PRIVATE_KEY=0x123..."))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"OVERRIDE_DIRECT_CACHE_SERVICE_URLS"),(0,a.kt)("td",{parentName:"tr",align:null},"Your personal private URLs of gateways to the RedStone data delivery network. For running local node you can simply put ",(0,a.kt)("inlineCode",{parentName:"td"},'OVERRIDE_DIRECT_CACHE_SERVICE_URLS=["https://httpbin.org/anything"]'),". But for production node running your should ",(0,a.kt)("a",{parentName:"td",href:"https://redstone.finance/discord"},"request them")," from the RedStone team."),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},'OVERRIDE_DIRECT_CACHE_SERVICE_URLS=["https://xxx.yyy.secret-url-1.com","https://zzz.aaa.secret-url-2.com"]'))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"OVERRIDE_MANIFEST_USING_FILE"),(0,a.kt)("td",{parentName:"tr",align:null},"Path to your manifest file. Manifest is a public JSON file that defines the provider's obligation regarding the data that they provide. It sets fetching interval, tokens, sources and other public technical details for the provided data. You can check available manifests ",(0,a.kt)("a",{parentName:"td",href:"https://github.com/redstone-finance/redstone-oracles-monorepo/tree/main/packages/oracle-node/manifests"},"here.")),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"OVERRIDE_MANIFEST_USING_FILE=./manifests/dev/dev.json"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"LEVEL_DB_LOCATION"),(0,a.kt)("td",{parentName:"tr",align:null},"Path to the level DB. Each RedStone oracle node relies on a single level DB. It is used to store recently fetched values from the last 15 minutes. These values are used for checking value deviations, filtering outliers and preventing price manipulations attacks. ",(0,a.kt)("br",null),(0,a.kt)("br",null)," You don't need to create a Level DB instance manually, it will be created automatically at the specified path during the first node launch."),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"LEVEL_DB_LOCATION=/oracle-node-level-db"))))),(0,a.kt)("h3",{id:"launch-using-docker"},"Launch using Docker"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://gallery.ecr.aws/y7v2w8b2/redstone-oracle-node"},"Link to the oracle-node Docker repository"))),(0,a.kt)("p",null,"Be sure to put your environment variables in the ",(0,a.kt)("inlineCode",{parentName:"p"},".env")," file using the instruction above."),(0,a.kt)("p",null,"Then, you can launch the RedStone oracle node using the following command:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"docker run --env-file .env -d --restart=always -v redstone-oracle-node:/oracle-node-level-db --name redstone-oracle-node public.ecr.aws/y7v2w8b2/redstone-oracle-node:6c5e4bf\n")),(0,a.kt)("admonition",{title:"Docker image tags",type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"Each docker image has a tag (e.g. ",(0,a.kt)("inlineCode",{parentName:"p"},"6c5e4bf"),"), which is a short commit hash from the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/redstone-finance/redstone-oracles-monorepo"},"redstone monorepo"),". It allows quickly identify the version of source code for a given docker image.")),(0,a.kt)("admonition",{title:"Custom local manifest",type:"info"},(0,a.kt)("p",{parentName:"admonition"},"If you want to run oracle-node from Docker with your custom manifest you should ",(0,a.kt)("a",{parentName:"p",href:"https://docs.docker.com/storage/bind-mounts/"},"mount the manifest file")," from your local system to the docker container and update the ",(0,a.kt)("inlineCode",{parentName:"p"},"OVERRIDE_MANIFEST_USING_FILE")," env variable.")),(0,a.kt)("h2",{id:"2-running-a-production-node"},"2. Running a production node"),(0,a.kt)("h3",{id:"reach-out-to-the-redstone-team"},"Reach out to the RedStone team"),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"Currently, we manually check and validate external data providers making sure that they fully understand the requirements and responsibility. The process might be automated by smart-contracts in the future.")),(0,a.kt)("p",null,"Please send your ethereum address and public key to the RedStone team. Your address and public key will be added to the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/redstone-finance/redstone-oracles-monorepo/blob/main/packages/oracles-smartweave-contracts/src/contracts/redstone-oracle-registry/initial-state.json"},"data providers registry"),". We'll also top up your ethereum wallet on Polygon with the small amount of MATIC tokens required for a one-time streamr streams creation, which will be started after your first node execution with a non-zero MATIC balance."),(0,a.kt)("p",null,"You can use ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/redstone-finance/redstone-oracles-monorepo/blob/main/packages/oracle-node/tools/ethereum/get-details-from-private-key.js"},"this script")," for obtaining your address and public key from your private key, but we strongly recommend to use your own trusted infrastructure for interacting with your private keys."),(0,a.kt)("p",null,"We will also send you personal private gateways to the RedStone data delivery network, which should be specified using the ",(0,a.kt)("inlineCode",{parentName:"p"},"OVERRIDE_DIRECT_CACHE_SERVICE_URLS")," environment variable."),(0,a.kt)("h3",{id:"deploy-your-node"},"Deploy your node"),(0,a.kt)("admonition",{title:"Follow best practices",type:"success"},(0,a.kt)("p",{parentName:"admonition"},"Before deploying your oracle node to production environment please take a look at the ",(0,a.kt)("a",{parentName:"p",href:"./best-practices"},"best practices")," for the nodes operation.")),(0,a.kt)("p",null,"Once you are added to the data providers registry and received your private gateway URLs, you can deploy the oracle node using Docker to any server or cloud provider you prefer. The deployment configuration should be very similar to the local node run."))}u.isMDXComponent=!0}}]);